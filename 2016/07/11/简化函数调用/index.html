<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Making Method Calls Simpler（简化函数调用） | INNER PEACE</title>
  <meta name="author" content="HuLin">
  
  <meta name="description" content="1.Rename Method（函数改名）2.Add Parameter（添加参数）3.Remove Parameter （移出参数）4.Separate Query From Modifier （将查询函数和修改函数分离）5.Parameterize Method （令函数携带参数）6.Replace Parameter with Explicit Methods（以明确函数取代参数）7.Preserve Whole Object（保持对象完整）8.Replace Parameter with Method（以对象取代参数）9.Indroduce Parameter Object（引入参数对象）10.Remove Setting Method（移除设值函数）11.Hide Method（隐藏函数）12.Replace Constructor with Factory Method（以工厂函数取代构造函数）13.Encapsulate Downcast（封装向下转型）14.Replace Error Code with Exception（以异常取代错误码）15.Replace Exception with Test（以测试取代异常）">
  
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="Making Method Calls Simpler（简化函数调用）"/>
  <meta property="og:site_name" content="INNER PEACE"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="INNER PEACE" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
</head>


<body>
<div id="page" class="site">
  <div id="primary" class="content-area">

    <header id="header" class="inner"><div class="site-branding">
  <h1 class="site-title">
    <a href="/">INNER PEACE</a>
  </h1>
  <p class="site-description"></p>
</div>
<nav id="site-navigation" class="main-navigation" role="navigation">
  <ul>
    
      <li><a href="/">主页</a></li>
    
      <li><a href="/archives">归档</a></li>
    
  </ul>
</nav></header>

    <article id="content" class="site-content">
      <main id="main" class="site-main posts-loop" role="main">
        <article class="post article">

  
  
    <h3 class="article-title"><span>Making Method Calls Simpler（简化函数调用）</span></h3>
  


  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2016/07/11/简化函数调用/" rel="bookmark">
        <time class="entry-date published" datetime="2016-07-10T23:49:53.000Z">
          2016-07-11
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h3 id="1-Rename-Method（函数改名）"><a href="#1-Rename-Method（函数改名）" class="headerlink" title="1.Rename Method（函数改名）"></a>1.Rename Method（函数改名）</h3><h3 id="2-Add-Parameter（添加参数）"><a href="#2-Add-Parameter（添加参数）" class="headerlink" title="2.Add Parameter（添加参数）"></a>2.Add Parameter（添加参数）</h3><h3 id="3-Remove-Parameter-（移出参数）"><a href="#3-Remove-Parameter-（移出参数）" class="headerlink" title="3.Remove Parameter （移出参数）"></a>3.Remove Parameter （移出参数）</h3><h3 id="4-Separate-Query-From-Modifier-（将查询函数和修改函数分离）"><a href="#4-Separate-Query-From-Modifier-（将查询函数和修改函数分离）" class="headerlink" title="4.Separate Query From Modifier （将查询函数和修改函数分离）"></a>4.Separate Query From Modifier （将查询函数和修改函数分离）</h3><h3 id="5-Parameterize-Method-（令函数携带参数）"><a href="#5-Parameterize-Method-（令函数携带参数）" class="headerlink" title="5.Parameterize Method （令函数携带参数）"></a>5.Parameterize Method （令函数携带参数）</h3><h3 id="6-Replace-Parameter-with-Explicit-Methods（以明确函数取代参数）"><a href="#6-Replace-Parameter-with-Explicit-Methods（以明确函数取代参数）" class="headerlink" title="6.Replace Parameter with Explicit Methods（以明确函数取代参数）"></a>6.Replace Parameter with Explicit Methods（以明确函数取代参数）</h3><h3 id="7-Preserve-Whole-Object（保持对象完整）"><a href="#7-Preserve-Whole-Object（保持对象完整）" class="headerlink" title="7.Preserve Whole Object（保持对象完整）"></a>7.Preserve Whole Object（保持对象完整）</h3><h3 id="8-Replace-Parameter-with-Method（以对象取代参数）"><a href="#8-Replace-Parameter-with-Method（以对象取代参数）" class="headerlink" title="8.Replace Parameter with Method（以对象取代参数）"></a>8.Replace Parameter with Method（以对象取代参数）</h3><h3 id="9-Indroduce-Parameter-Object（引入参数对象）"><a href="#9-Indroduce-Parameter-Object（引入参数对象）" class="headerlink" title="9.Indroduce Parameter Object（引入参数对象）"></a>9.Indroduce Parameter Object（引入参数对象）</h3><h3 id="10-Remove-Setting-Method（移除设值函数）"><a href="#10-Remove-Setting-Method（移除设值函数）" class="headerlink" title="10.Remove Setting Method（移除设值函数）"></a>10.Remove Setting Method（移除设值函数）</h3><h3 id="11-Hide-Method（隐藏函数）"><a href="#11-Hide-Method（隐藏函数）" class="headerlink" title="11.Hide Method（隐藏函数）"></a>11.Hide Method（隐藏函数）</h3><h3 id="12-Replace-Constructor-with-Factory-Method（以工厂函数取代构造函数）"><a href="#12-Replace-Constructor-with-Factory-Method（以工厂函数取代构造函数）" class="headerlink" title="12.Replace Constructor with Factory Method（以工厂函数取代构造函数）"></a>12.Replace Constructor with Factory Method（以工厂函数取代构造函数）</h3><h3 id="13-Encapsulate-Downcast（封装向下转型）"><a href="#13-Encapsulate-Downcast（封装向下转型）" class="headerlink" title="13.Encapsulate Downcast（封装向下转型）"></a>13.Encapsulate Downcast（封装向下转型）</h3><h3 id="14-Replace-Error-Code-with-Exception（以异常取代错误码）"><a href="#14-Replace-Error-Code-with-Exception（以异常取代错误码）" class="headerlink" title="14.Replace Error Code with Exception（以异常取代错误码）"></a>14.Replace Error Code with Exception（以异常取代错误码）</h3><h3 id="15-Replace-Exception-with-Test（以测试取代异常）"><a href="#15-Replace-Exception-with-Test（以测试取代异常）" class="headerlink" title="15.Replace Exception with Test（以测试取代异常）"></a>15.Replace Exception with Test（以测试取代异常）</h3><a id="more"></a>
<h3 id="1-Rename-Method（函数改名）-1"><a href="#1-Rename-Method（函数改名）-1" class="headerlink" title="1.Rename Method（函数改名）"></a>1.Rename Method（函数改名）</h3><p>名字应该表达函数体的意思，取名时可根据注释来取<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getTelephoneNumber</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> (<span class="string">"("</span> + _officeAreaCode + <span class="string">") "</span> + _officeNumber);</div><div class="line">&#125;</div><div class="line"></div><div class="line">----------</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>...</span></div><div class="line"><span class="title">public</span> <span class="title">String</span> <span class="title">getTelephoneNumber</span>()&#123;</div><div class="line">    <span class="keyword">return</span> getOfficeTelephoneNumber(); </div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getOfficeTelephoneNumber</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> (<span class="string">"("</span> + _officeAreaCode + <span class="string">") "</span> + _officeNumber);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="2-Add-Parameter（添加参数）-1"><a href="#2-Add-Parameter（添加参数）-1" class="headerlink" title="2.Add Parameter（添加参数）"></a>2.Add Parameter（添加参数）</h3><p>书中不建议这么做，参数太长影响代码可读性，可查看是否可以通过现有的参数传递，或者其他可替代的方法。</p>
<h3 id="3-Remove-Parameter-（移出参数）-1"><a href="#3-Remove-Parameter-（移出参数）-1" class="headerlink" title="3.Remove Parameter （移出参数）"></a>3.Remove Parameter （移出参数）</h3><p>删除不再被方法使用的参数</p>
<h3 id="4-Separate-Query-From-Modifier-（将查询函数和修改函数分离）-1"><a href="#4-Separate-Query-From-Modifier-（将查询函数和修改函数分离）-1" class="headerlink" title="4.Separate Query From Modifier （将查询函数和修改函数分离）"></a>4.Separate Query From Modifier （将查询函数和修改函数分离）</h3><p>一个方法既返回值也改变对象的状态时应该将其拆分成两个不同的方法。单一指责的原则。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="function">String <span class="title">foundMiscreant</span><span class="params">(String[] people)</span></span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; people.length; i++) &#123;</div><div class="line">        <span class="keyword">if</span> (people[i].equals (<span class="string">"Don"</span>))&#123; </div><div class="line">            sendAlert();</div><div class="line">            <span class="keyword">return</span> <span class="string">"Don"</span>; </div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (people[i].equals (<span class="string">"John"</span>))&#123; </div><div class="line">            sendAlert();</div><div class="line">            <span class="keyword">return</span> <span class="string">"John"</span>; </div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="string">""</span>; </div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">checkSecurity</span><span class="params">(String[] people)</span> </span>&#123; </div><div class="line">    String found = foundMiscreant(people); </div><div class="line">    someLaterCode(found);</div><div class="line">&#125;</div><div class="line"></div><div class="line">----------</div><div class="line"><span class="function">String <span class="title">foundPerson</span><span class="params">(String[] people)</span></span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; people.length; i++) &#123;</div><div class="line">        <span class="keyword">if</span> (people[i].equals (<span class="string">"Don"</span>))&#123; </div><div class="line">            <span class="keyword">return</span> <span class="string">"Don"</span>;</div><div class="line">        &#125;</div><div class="line">    <span class="keyword">if</span> (people[i].equals (<span class="string">"John"</span>))&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"John"</span>; </div><div class="line">    &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">sendAlert</span> <span class="params">(String[] people)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (! foundPerson(people).equals(<span class="string">""</span>))</div><div class="line">        sendAlert();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">checkSecurity</span><span class="params">(String[] people)</span> </span>&#123; </div><div class="line">    sendAlert(people);</div><div class="line">    String found = foundPerson(people); </div><div class="line">    someLaterCode(found);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="5-Parameterize-Method-（令函数携带参数）-1"><a href="#5-Parameterize-Method-（令函数携带参数）-1" class="headerlink" title="5.Parameterize Method （令函数携带参数）"></a>5.Parameterize Method （令函数携带参数）</h3><p>几个方法非常相似，只是因为包含几个不同的值，可将其抽成一个方法，不同的值通过参数的方法传递进去。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">protected</span> Dollars <span class="title">baseCharge</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">double</span> result = Math.min(lastUsage(),<span class="number">100</span>) * <span class="number">0.03</span>; </div><div class="line">    <span class="keyword">if</span> (lastUsage() &gt; <span class="number">100</span>) &#123;</div><div class="line">        result += (Math.min (lastUsage(),<span class="number">200</span>) - <span class="number">100</span>) * <span class="number">0.05</span>; &#125;;</div><div class="line">    <span class="keyword">if</span> (lastUsage() &gt; <span class="number">200</span>) &#123;</div><div class="line">        result += (lastUsage() - <span class="number">200</span>) * <span class="number">0.07</span>;</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Dollars (result); </div><div class="line">&#125;</div><div class="line">----------</div><div class="line"><span class="function"><span class="keyword">protected</span> Dollars <span class="title">baseCharge</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">double</span> result = usageInRange(<span class="number">0</span>, <span class="number">100</span>) * <span class="number">0.03</span>;</div><div class="line">    result += usageInRange (<span class="number">100</span>,<span class="number">200</span>) * <span class="number">0.05</span>;</div><div class="line">    result += usageInRange (<span class="number">200</span>, Integer.MAX_VALUE) * <span class="number">0.07</span>;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Dollars (result);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">int</span> <span class="title">usageInRange</span><span class="params">(<span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (lastUsage() &gt; start) </div><div class="line">        <span class="keyword">return</span> Math.min(lastUsage(),end) - start;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="6-Replace-Parameter-with-Explicit-Methods（以明确函数取代参数）-1"><a href="#6-Replace-Parameter-with-Explicit-Methods（以明确函数取代参数）-1" class="headerlink" title="6.Replace Parameter with Explicit Methods（以明确函数取代参数）"></a>6.Replace Parameter with Explicit Methods（以明确函数取代参数）</h3><p>当一个方法根据参数不同的值执行不同的代码段时可以为每一个不同的值创建一个方法<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">setValue</span> <span class="params">(String name, <span class="keyword">int</span> value)</span> </span>&#123; </div><div class="line">    <span class="keyword">if</span> (name.equals(<span class="string">"height"</span>))</div><div class="line">        _height = value;</div><div class="line">    <span class="keyword">if</span> (name.equals(<span class="string">"width"</span>))</div><div class="line">        _width = value; Assert.shouldNeverReachHere();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">setHeight</span><span class="params">(<span class="keyword">int</span> arg)</span> </span>&#123; </div><div class="line">    _height = arg;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">setWidth</span> <span class="params">(<span class="keyword">int</span> arg)</span> </span>&#123;</div><div class="line">    _width = arg; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="7-Preserve-Whole-Object（保持对象完整）-1"><a href="#7-Preserve-Whole-Object（保持对象完整）-1" class="headerlink" title="7.Preserve Whole Object（保持对象完整）"></a>7.Preserve Whole Object（保持对象完整）</h3><p>当传递给方法的不同参数来至同一个对象，可对象直接传入方法，保证对象的完整性，亦方法后面扩展。当然如果一个方法使用对象上的很多属性或方法，这时得考虑这个对象的存放位置了。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Room</span>...</span></div><div class="line"><span class="title">boolean</span> <span class="title">withinPlan</span>(<span class="title">HeatingPlan</span> <span class="title">plan</span>) &#123;</div><div class="line">    <span class="keyword">int</span> low = daysTempRange().getLow(); </div><div class="line">    <span class="keyword">int</span> high = daysTempRange().getHigh(); </div><div class="line">    <span class="keyword">return</span> plan.withinRange(low, high);</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HeatingPlan</span>...</span></div><div class="line"><span class="title">boolean</span> <span class="title">withinRange</span> (<span class="title">int</span> <span class="title">low</span>, <span class="title">int</span> <span class="title">high</span>) &#123;</div><div class="line">    <span class="keyword">return</span> (low &gt;= _range.getLow() &amp;&amp; high &lt;= _range.getHigh());</div><div class="line">&#125;</div><div class="line"><span class="keyword">private</span> TempRange _range;</div><div class="line">----------</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HeatingPlan</span>...</span></div><div class="line">    <span class="title">boolean</span> <span class="title">withinRange</span> (<span class="title">TempRange</span> <span class="title">roomRange</span>) &#123;</div><div class="line">    <span class="keyword">return</span> (_range.includes(roomRange)); &#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TempRange</span>...</span></div><div class="line">    <span class="title">boolean</span> <span class="title">includes</span> (<span class="title">TempRange</span> <span class="title">arg</span>) &#123;</div><div class="line">    <span class="keyword">return</span> arg.getLow() &gt;= <span class="keyword">this</span>.getLow() &amp;&amp; arg.getHigh() &lt;= <span class="keyword">this</span>.getHigh();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="8-Replace-Parameter-with-Method（以对象取代参数）-1"><a href="#8-Replace-Parameter-with-Method（以对象取代参数）-1" class="headerlink" title="8.Replace Parameter with Method（以对象取代参数）"></a>8.Replace Parameter with Method（以对象取代参数）</h3><p>当一个对象调用方法获得的结果作为另外一个方法的参数时，可直接将参数换成函数的调用。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> basePrice = _quantity * _itemPrice;</div><div class="line">    <span class="keyword">int</span> discountLevel;</div><div class="line">    <span class="keyword">if</span> (_quantity &gt; <span class="number">100</span>) discountLevel = <span class="number">2</span>;</div><div class="line">    <span class="keyword">else</span> discountLevel = <span class="number">1</span>;</div><div class="line">    <span class="keyword">double</span> finalPrice = discountedPrice (basePrice, discountLevel); </div><div class="line">    <span class="keyword">return</span> finalPrice;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">double</span> <span class="title">discountedPrice</span> <span class="params">(<span class="keyword">int</span> basePrice, <span class="keyword">int</span> discountLevel)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (discountLevel == <span class="number">2</span>) <span class="keyword">return</span> basePrice * <span class="number">0.1</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> basePrice * <span class="number">0.05</span>; </div><div class="line">&#125;</div><div class="line">----------</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (getDiscountLevel() == <span class="number">2</span>) <span class="keyword">return</span> getBasePrice() * <span class="number">0.1</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> getBasePrice() * <span class="number">0.05</span>; </div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getDiscountLevel</span><span class="params">()</span> </span>&#123; </div><div class="line">    <span class="keyword">if</span> (_quantity &gt; <span class="number">100</span>) <span class="keyword">return</span> <span class="number">2</span>; </div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">double</span> <span class="title">getBasePrice</span><span class="params">()</span> </span>&#123; </div><div class="line">    <span class="keyword">return</span> _quantity * _itemPrice;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="9-Indroduce-Parameter-Object（引入参数对象）-1"><a href="#9-Indroduce-Parameter-Object（引入参数对象）-1" class="headerlink" title="9.Indroduce Parameter Object（引入参数对象）"></a>9.Indroduce Parameter Object（引入参数对象）</h3><p>当有一组参数时，可引入对象来包含参数，不仅能增加代码的可读性，而且可将一些修改参数的方法也一并方法对象，减少重复的代码。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Account</span>...</span></div><div class="line"><span class="title">double</span> <span class="title">getFlowBetween</span> (<span class="title">Date</span> <span class="title">start</span>, <span class="title">Date</span> <span class="title">end</span>) &#123;</div><div class="line">    <span class="keyword">double</span> result = <span class="number">0</span>;</div><div class="line">    Enumeration e = _entries.elements(); </div><div class="line">    <span class="keyword">while</span> (e.hasMoreElements()) &#123;</div><div class="line">        Entry each = (Entry) e.nextElement(); </div><div class="line">        <span class="keyword">if</span> (each.getDate().equals(start) ||</div><div class="line">            each.getDate().equals(end) || </div><div class="line">            (each.getDate().after(start) &amp;&amp;</div><div class="line">            each.getDate().before(end))) &#123;</div><div class="line">            result += each.getValue(); </div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"><span class="keyword">private</span> Vector _entries = <span class="keyword">new</span> Vector();</div><div class="line">----------</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DateRange</span> </span>&#123;</div><div class="line">DateRange (Date start, Date end) &#123;</div><div class="line">    _start = start;</div><div class="line">    _end = end; </div><div class="line">&#125;</div><div class="line"><span class="function">Date <span class="title">getStart</span><span class="params">()</span> </span>&#123; </div><div class="line">    <span class="keyword">return</span> _start;</div><div class="line">&#125;</div><div class="line"><span class="function">Date <span class="title">getEnd</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> _end; </div><div class="line">&#125;</div><div class="line"><span class="keyword">private</span> <span class="keyword">final</span> Date _start;</div><div class="line"><span class="keyword">private</span> <span class="keyword">final</span> Date _end;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">getFlowBetween</span> <span class="params">(DateRange range)</span> </span>&#123;</div><div class="line">    <span class="keyword">double</span> result = <span class="number">0</span>;</div><div class="line">    Enumeration e = _entries.elements(); </div><div class="line">    <span class="keyword">while</span> (e.hasMoreElements()) &#123;</div><div class="line">        Entry each = (Entry) e.nextElement(); </div><div class="line">        <span class="keyword">if</span> (range.includes(each.getDate())) &#123;</div><div class="line">            result += each.getValue(); </div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">includes</span> <span class="params">(Date arg)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> (arg.equals(_start) || arg.equals(_end) || (arg.after(_start) &amp;&amp; arg.before(_end)));</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="10-Remove-Setting-Method（移除设值函数）-1"><a href="#10-Remove-Setting-Method（移除设值函数）-1" class="headerlink" title="10.Remove Setting Method（移除设值函数）"></a>10.Remove Setting Method（移除设值函数）</h3><p>当参数值只有在构造函数设置时，其他时候不改，可将设置方法去掉。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Account</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String _id; </div><div class="line">    Account (String id) &#123;</div><div class="line">        setId(id); </div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setId</span> <span class="params">(String arg)</span> </span>&#123; </div><div class="line">        _id = arg;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">----------</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Account</span> </span>&#123;</div><div class="line"><span class="keyword">private</span> <span class="keyword">final</span> String _id;</div><div class="line">    Account (String id) &#123; </div><div class="line">        _id = id;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="11-Hide-Method（隐藏函数）-1"><a href="#11-Hide-Method（隐藏函数）-1" class="headerlink" title="11.Hide Method（隐藏函数）"></a>11.Hide Method（隐藏函数）</h3><p>方法不被其他类使用时，应该将其隐藏掉。</p>
<h3 id="12-Replace-Constructor-with-Factory-Method（以工厂函数取代构造函数）-1"><a href="#12-Replace-Constructor-with-Factory-Method（以工厂函数取代构造函数）-1" class="headerlink" title="12.Replace Constructor with Factory Method（以工厂函数取代构造函数）"></a>12.Replace Constructor with Factory Method（以工厂函数取代构造函数）</h3><p>当需要创建复杂的类时，可用工厂方法替代构造函数。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> _type;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> ENGINEER = <span class="number">0</span>; </div><div class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SALESMAN = <span class="number">1</span>; </div><div class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MANAGER = <span class="number">2</span>;</div><div class="line">    Employee (<span class="keyword">int</span> type) &#123; </div><div class="line">        _type = type;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">----------</div><div class="line"><span class="function"><span class="keyword">static</span> Employee <span class="title">create</span><span class="params">(<span class="keyword">int</span> type)</span> </span>&#123; </div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Employee(type);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="title">Employee</span> <span class="params">(<span class="keyword">int</span> type)</span> </span>&#123;</div><div class="line">    _type = type; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="13-Encapsulate-Downcast（封装向下转型）-1"><a href="#13-Encapsulate-Downcast（封装向下转型）-1" class="headerlink" title="13.Encapsulate Downcast（封装向下转型）"></a>13.Encapsulate Downcast（封装向下转型）</h3><p>当方法放回的对象需要转型时，尽量在方法内转型<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function">Object <span class="title">lastReading</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> readings.lastElement();</div><div class="line">&#125;</div><div class="line">----------</div><div class="line"><span class="function">Reading <span class="title">lastReading</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> (Reading) readings.lastElement();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="14-Replace-Error-Code-with-Exception（以异常取代错误码）-1"><a href="#14-Replace-Error-Code-with-Exception（以异常取代错误码）-1" class="headerlink" title="14.Replace Error Code with Exception（以异常取代错误码）"></a>14.Replace Error Code with Exception（以异常取代错误码）</h3><p>用异常取代错误码<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">withdraw</span><span class="params">(<span class="keyword">int</span> amount)</span> </span>&#123; </div><div class="line">    <span class="keyword">if</span> (amount &gt; _balance)</div><div class="line">    <span class="keyword">return</span> -<span class="number">1</span>; </div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        _balance -= amount;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">-------</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">withdraw</span><span class="params">(<span class="keyword">int</span> amount)</span> <span class="keyword">throws</span> BalanceException </span>&#123;</div><div class="line">    <span class="keyword">if</span> (amount &gt; _balance) <span class="keyword">throw</span> <span class="keyword">new</span> BalanceException(); </div><div class="line">    _balance -= amount;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="15-Replace-Exception-with-Test（以测试取代异常）-1"><a href="#15-Replace-Exception-with-Test（以测试取代异常）-1" class="headerlink" title="15.Replace Exception with Test（以测试取代异常）"></a>15.Replace Exception with Test（以测试取代异常）</h3><p>用测试取代异常，有的条件是需要先检验的。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">getValueForPeriod</span> <span class="params">(<span class="keyword">int</span> periodNumber)</span> </span>&#123; </div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        <span class="keyword">return</span> _values[periodNumber];</div><div class="line">    &#125; <span class="keyword">catch</span> (ArrayIndexOutOfBoundsException e) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">----------</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">getValueForPeriod</span> <span class="params">(<span class="keyword">int</span> periodNumber)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (periodNumber &gt;= _values.length) <span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">    <span class="keyword">return</span> _values[periodNumber];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
        <div class="article-meta pull-left">
          
          
        </div>
        
    </footer>
  </div>
</article>

  
	<div id="comment">
	
	
	<!-- 多说评论框 start -->
	 <div class="ds-thread" data-thread-key="/2016/07/11/简化函数调用/" data-title="Making Method Calls Simpler（简化函数调用）" data-url="http://flyingalex.github.io/2016/07/11/简化函数调用/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"hulinalex"};
	  (function() {
	    var ds = document.createElement('script');
	    ds.type = 'text/javascript';ds.async = true;
	    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
	    ds.charset = 'UTF-8';
	    (document.getElementsByTagName('head')[0] 
	     || document.getElementsByTagName('body')[0]).appendChild(ds);
	  })();
	  </script>
	<!-- 多说公共JS代码 end -->
	
	</div>




      </main>
    </article>

    <footer id="colophon" class="site-footer" role="contentinfo"><p class="site-info">
  Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
  Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
  </br>
  
  &copy; 2016 HuLin
  
</p>
</footer>
    
  </div>
</div>
</body>
</html>